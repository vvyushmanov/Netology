
# Домашнее задание к занятию «Микросервисы: принципы»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

## Ответ

| API Gateway              | Маршрутизация запросов | Проверка аутентификации | Терминация HTTPS |
|--------------------------|-----------------------|-------------------------|------------------|
| Amazon API Gateway       | Да                    | Да                      | Да               |
| Kong                     | Да                    | Да                      | Да               |
| Apigee                   | Да                    | Да                      | Да               |
| Azure API Management     | Да                    | Да                      | Да               |
| Tyk                      | Да                    | Да                      | Да               |
| MuleSoft Anypoint Platform | Да                    | Да                      | Да               |
| NGINX Plus               | Да                    | Да                      | Да               |
| Spring WebFlux           | Да                    | Да                      | Да               |

Все перечисленные сервисы отвечают заявленным требованиям, и могут быть использованы в зависимости от специфики проекта (например, Spring WebFlux имеет смысл использовать того, когда большая часть проекта написана на Java/Kotlin, с использованием фреймворка Spring - в это случае, разработчикам проще будет его поддерживать).

Однако, в общем случае, имеет смысл использовать **Kong**.

**Обоснование:**

1. **Гибкость и масштабируемость:** Kong является платформой с открытым исходным кодом, которая обладает гибкостью и расширяемостью для адаптации к различным требованиям. Он может легко масштабироваться для обработки высокой нагрузки, что является важным в случае микросервисной архитектуры, где количество сервисов может быть значительным.

2. **Обширные возможности:** Kong предлагает широкий набор функций API gateway, включая маршрутизацию запросов, проверку аутентификации и терминацию HTTPS. Он также обеспечивает управление трафиком, мониторинг, логирование и другие возможности, которые могут быть важными для разработки и эксплуатации вашей системы.

3. **Сообщество и поддержка:** Kong имеет активное сообщество разработчиков и пользователей, что обеспечивает доступ к обширной документации, руководствам и форумам для получения поддержки и решения возникающих вопросов.

4. **Интеграция с экосистемой:** Kong интегрируется с другими инструментами и технологиями, которые часто используются в микросервисных архитектурах, такими как Service Discovery и Load Balancer. Это позволяет создать совместимую и эффективную инфраструктуру для разработки и эксплуатации микросервисов.

5. **Открытый исходный код:** Благодаря тому, что Kong является платформой с открытым исходным кодом, вы получаете преимущество свободы в использовании, адаптации и распространении решения. Вы можете активно вносить изменения и расширять функциональность в соответствии с вашими потребностями.

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

## Ответ

| Брокер сообщений       | Поддержка кластеризации | Хранение сообщений на диске | Высокая скорость работы | Поддержка форматов сообщений | Разделение прав доступа | Простота эксплуатации |
|------------------------|-------------------------|----------------------------|-------------------------|------------------------------|-------------------------|----------------------|
| Apache Kafka           | Да                      | Да                         | Да                      | Да                           | Да                      | Да                   |
| RabbitMQ               | Да                      | Да                         | Да                      | Да                           | Да                      | Да                   |
| Apache ActiveMQ        | Да                      | Да                         | Да                      | Да                           | Да                      | Да                   |
| NATS Streaming         | Да                      | Да                         | Да                      | Да                           | Да                      | Да                   |
| Amazon SQS             | Да                      | Да                         | Да                      | Да                           | Да                      | Да                   |
| Google Cloud Pub/Sub   | Да                      | Да                         | Да                      | Да                           | Да                      | Да                   |
| Microsoft Azure Service Bus | Да                      | Да                         | Да                      | Да                           | Да                      | Да                   |
| Apache Pulsar          | Да                      | Да                         | Да                      | Да                           | Да                      | Да                   |

**Рекомендация: Apache Kafka**

**Обоснование:**

1. **Поддержка кластеризации:** Apache Kafka обеспечивает высокую надежность и отказоустойчивость путем поддержки кластеризации. Это позволяет создать распределенный брокер сообщений с репликацией данных, что обеспечивает сохранность сообщений и возможность продолжения работы даже при отказе узлов.

2. **Хранение сообщений на диске:** Apache Kafka хранит сообщения на диске в процессе доставки, что обеспечивает сохранность сообщений в случае временных сбоев и позволяет обрабатывать большие объемы данных.

3. **Высокая скорость работы:** Apache Kafka предлагает высокую пропускную способность и низкую задержку при передаче сообщений. Он способен обрабатывать миллионы сообщений в секунду, что является важным при работе с высоконагруженными системами.

4. **Поддержка различных форматов сообщений:** Apache Kafka поддерживает гибкий формат данных, что позволяет передавать сообщения в различных форматах, включая JSON, Avro и другие.

5. **Разделение прав доступа:** Apache Kafka предоставляет механизм разделения прав доступа к различным потокам сообщений. Это позволяет управлять доступом и обеспечить безопасность передачи данных в системе.

6. **Простота эксплуатации:** Apache Kafka имеет развитое сообщество пользователей и обширную документацию, что облегчает его внедрение, настройку и поддержку. Он также интегрируется с различными инструментами и фреймворками, что упрощает его использование в разных сценариях.
